**Use the timing attack**

Now that we know there's a timing attack, we can write a python script to exploit it.

The first step is working out how login requests work. You can use Burpsuite for this, but I prefer to use Firefox dev tools as I don't have to configure any proxies.

Here we can see the login is a POST request to /api/user/login. This means we can make this request using CURL, python or another programming language of your choice.

![](https://i.imgur.com/swXlKKU.png)

In python, we can use this code and the Requests library to send this request as follows:

creds = {"username":username,"password":"invalidPassword!"}
response = r.post(URL,json=creds)

The next stage is timing this. Using the "time" standard library, we can work out the time difference between when we send the request and when we get a response. I've moved the login request into it's own function called doLogin.

startTime = time.time()
doLogin(user)
endTime = time.time()

The next step is now to repeat this for all usernames in the username list. This can be done with a series of for loops. The first will read usernames from a file into a list, and the second will test each of these usernames and see the time taken to respond. For my exploit, I decided that times within 10% of the largest time were likely to be valid usernames.  
  

**Why does the time taken change?**

The backend is intentionally poorly written. The server will only try to verify the password of the user if it receives a correct username. The psuedocode to explain this better is below.

HackerNote Login Code

![[Pasted image 20240227225659.png]]


Pre-written exploits in Golang and Python are available here: [https://github.com/NinjaJc01/hackerNoteExploits](https://github.com/NinjaJc01/hackerNoteExploits)[](https://github.com/NinjaJc01/hackerNoteExploits)

Use the Honeypot capture or Names/names.txt from [https://github.com/danielmiessler/SecLists/tree/master/Usernames](https://github.com/danielmiessler/SecLists/tree/master/Usernames). The shorter the list is, the faster the exploit will complete. (Hint: one of those wordlists is shorter.)

**NOTE:** The Golang exploit is not reliable but it is faster. If you get invalid usernames, try re-running it after a minute or switching to the python exploit.

#### Testing the login page

Try wrong credentials (right username and a random password it has a little delay):

_Invalid Username Or Password

Only a username:

_Wrong credential encoding_

Password reset:

Use registered username:

![[Pasted image 20240227222444.png]]


Trying with `admin` doesn’t return anything!


Use `curl` to check what’s really going on in the background:

```
curl 'http://10.10.203.32/api/user/passwordhint/user'
```

![[Pasted image 20240227223021.png]]


**Fuzzing the admin user’s name:**

Using `ffuf` to fuzz the administrator’s username and get his hint:

```
ffuf -u 'http://10.10.203.32/api/user/passwordhint/FUZZ' -w /usr/share/wordlists/seclists/Usernames/Names/names.txt -o scans/ffuf_names
```


![[Pasted image 20240227223853.png]]


Try getting a **password hint** for the found user:

```
curl 'http://10.10.203.32/api/user/passwordhint/james'
```

![[Pasted image 20240227224652.png]]




Answer the questions below

| Question                                          |       |
| ------------------------------------------------- | ----- |
| Try to write a script to perform a timing attack. |       |
| How many usernames from the list are valid?       | 1     |
| What are/is the valid username(s)?                | james |
